<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GrotesQuest - Find and learn about campus grotesques in this scavenger hunt">
    <meta name="theme-color" content="#e8e3d9">
    <title>G11. Antoine Lavoisier</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Reset and base styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'IM Fell English', serif;
            margin: 0;
            padding: 16px;
            background-color: #e8e3d9;
            color: #2c1810;
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
            padding: 24px 16px;
            background: white;
            border: 1px solid #2c1810;
            box-shadow: 0 4px 8px rgba(44, 24, 16, 0.2);
            border-radius: 4px;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin: 0 0 24px 0;
            color: #2c1810;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            text-shadow: 1px 1px 0 rgba(232, 227, 217, 0.5);
            padding-right: 70px; /* Make room for the seal */
        }

        /* Wax seal styles */
        .points-seal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
        }
        
        .seal-svg {
            width: 100%;
            height: 100%;
            fill: #2c1810; /* Same dark brown as the buttons */
        }
        
        .seal-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 1rem;
            color: #e8e3d9; /* Light text color for contrast */
            text-align: center;
            line-height: 1;
            width: 100%;
        }
        
        .seal-text .pts {
            font-size: 0.8rem;
            display: block;
            margin-top: 2px;
        }

        .congratulations {
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 16px;
            padding: 16px;
            background: #e8e3d9;
            border: 1px solid #2c1810;
            border-radius: 4px;
        }

        .points {
            font-weight: bold;
            color: #937c43;
        }

        .grotesque-name {
            font-style: italic;
        }

        .instructions {
            margin: 16px 0 24px 0;
            background: #f7f4ed;
            border: 1px dashed #2c1810;
            padding: 12px;
            border-radius: 4px;
            font-style: italic;
            text-align: center;
        }

        .button-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-width: 300px;
            margin: 0 auto;
        }

        .button {
            display: flex;
            align-items: center;
            justify-content: center; /* Center button text */
            padding: 16px 24px;
            background: #2c1810;
            color: #e8e3d9;
            text-align: center;
            text-decoration: none;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            position: relative; /* For positioning the step number */
        }

        .button::before {
            content: attr(data-step);
            position: absolute;
            left: 16px;
            background: #e8e3d9;
            color: #2c1810;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            font-size: 0.9rem;
        }

        .button:hover, 
        .button:focus {
            transform: translateY(-2px);
            background: #3d2416;
            outline: none;
        }
        
        .button:active {
            transform: translateY(1px);
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 24, 16, 0.9);
            z-index: 1000;
            overflow-y: auto;
            backdrop-filter: blur(3px);
            -webkit-backdrop-filter: blur(3px);
        }

        .modal-content {
            position: relative;
            width: 90%;
            max-width: 800px;
            margin: 40px auto;
            background: white;
            padding: 20px;
            border: 1px solid #2c1810;
            border-radius: 4px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 16px;
        }

        .modal-button {
            padding: 12px 20px;
            background: #2c1810;
            color: #e8e3d9;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            transition: transform 0.2s, background-color 0.2s;
            flex: 1;
            -webkit-tap-highlight-color: transparent;
            text-align: center;
        }

        .modal-button:hover,
        .modal-button:focus {
            transform: translateY(-2px);
            background: #3d2416;
            outline: none;
        }

        .close-button {
            position: absolute;
            right: 20px;
            top: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #2c1810;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            z-index: 5;
        }

        /* Video container styles */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            background-color: #000; /* Black background for video loading */
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 1px solid #2c1810;
            border-radius: 2px;
        }

        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #2c1810;
            color: #e8e3d9;
            font-family: 'Playfair Display', serif;
        }

        .video-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(44, 24, 16, 0.8);
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #e8e3d9;
            z-index: 2;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        .video-close:hover {
            background: #2c1810;
            transform: scale(1.1);
        }

        /* Form container styles */
        .form-container {
            height: 450px;
            background: #fff;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .form-container iframe {
            width: 100%;
            height: 100%;
            border: 1px solid #2c1810;
            background: transparent;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .form-container iframe.loaded {
            opacity: 1;
        }

        .form-loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #fff;
            color: #2c1810;
            font-family: 'IM Fell English', serif;
            font-style: italic;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(44, 24, 16, 0.1);
            border-radius: 50%;
            border-top-color: #2c1810;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive styles */
        @media (max-width: 600px) {
            body {
                padding: 8px;
            }

            .container {
                padding: 16px 12px;
            }

            h1 {
                font-size: 1.75rem;
                margin-bottom: 16px;
            }

            .congratulations {
                font-size: 1.1rem;
                padding: 12px;
            }

            .modal-content {
                margin: 20px auto;
                padding: 16px;
                width: 95%;
            }

            .form-container {
                height: 500px;
            }
            
            .button, .modal-button {
                padding: 14px 20px; /* Slightly larger touch targets on mobile */
            }
            
            .points-seal {
                width: 60px;
                height: 60px;
                top: 15px;
                right: 15px;
            }
            
            .seal-text {
                font-size: 0.9rem;
            }
            
            .seal-text .pts {
                font-size: 0.7rem;
            }
        }

        /* High contrast mode for outdoor visibility */
        @media (prefers-contrast: high) {
            body {
                background-color: white;
                color: black;
            }
            
            .container {
                border: 2px solid black;
                background: white;
            }
            
            .button, .modal-button {
                background: black;
                color: white;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>G11. Antoine Lavoisier</h1>
        
        <div class="points-seal">
            <svg class="seal-svg" viewBox="0 0 1200 1200" xmlns="http://www.w3.org/2000/svg">
                <path d="m985.56 608.76c0 105.02-41.719 205.75-115.98 280.01-74.266 74.266-174.99 115.99-280.02 115.99-105.02 0-205.75-41.723-280.01-115.99-74.266-74.262-115.99-174.99-115.99-280.01 0-105.03 41.723-205.75 115.99-280.02 74.262-74.266 174.99-115.98 280.01-115.98 105.03 0 205.75 41.719 280.02 115.98s115.98 174.99 115.98 280.02zm115.56-114.36 0.003906-0.003906c8.9609 31.645 7.3594 65.348-4.5625 96-5.0664 13.883-8.0156 28.445-8.7578 43.203 0 231.96-198.96 414.6-391.2 457.2-10.559 2.2812-21.238 5.6406-31.559 8.8789h-0.003907c-20.863 7.7852-42.797 12.316-65.039 13.441-25.672-1.3203-51.035-6.207-75.359-14.52-12-3.3594-22.559-6.4805-33.238-8.8789l-0.003906-0.003906c-108.83-24.66-206.09-85.473-275.91-172.52-69.824-87.039-108.09-195.18-108.56-306.76-0.76562-13.918-3.3477-27.676-7.6836-40.922-6.4727-17.758-8.7734-36.77-6.7188-55.559 5.4648-18.59 13.891-36.176 24.961-52.082 7.0273-10.742 13.129-22.062 18.238-33.84 69.84-187.32 251.16-308.04 461.88-308.04 23.461-1.7305 46.484-7.2852 68.16-16.441 31.078-11.039 63.359-22.441 92.52-12.84 34.922 12 77.762 46.801 115.56 77.879 14.762 12 28.68 24 40.199 31.922 19.988 13.07 41.359 23.895 63.723 32.281 37.559 15.84 76.441 32.281 96.84 64.32 44.16 69.602 36 112.56 28.559 147.24-4.832 16.25-5.5352 33.449-2.0391 50.039zm-432.36-338.4c1.1289 3.1758 4.6172 4.8398 7.7969 3.7188 37.477-13.324 79.051-8.1172 112.08 14.043 11.102 7.5547 21.117 16.598 29.758 26.879 1.9141 2.3672 5.2969 2.9297 7.8711 1.3047s3.5234-4.918 2.2109-7.6641c-13.41-28.527-38.328-49.996-68.52-59.043-15.113-4.7773-31.09-6.168-46.801-4.0781-15.688 1.9414-30.52 8.2188-42.84 18.121-1.8555 1.7031-2.4727 4.3711-1.5586 6.7188zm328.8 452.76c0-108.21-42.984-211.99-119.5-288.5-76.516-76.516-180.29-119.5-288.5-119.5-108.21 0-211.98 42.984-288.5 119.5-76.512 76.512-119.5 180.29-119.5 288.5 0 108.21 42.988 211.98 119.5 288.5 76.516 76.516 180.29 119.5 288.5 119.5 108.21 0 211.98-42.988 288.5-119.5 76.516-76.512 119.5-180.29 119.5-288.5zm62.52-112.68v-0.003906c-2.625-7.3594-4.5508-14.953-5.7578-22.68-1.3203-7.6797-2.6406-15.238-3.6016-23.039s-2.7617-15.359-3.9609-23.16c-1.1992-7.8008-3.3594-15.359-5.1602-23.16h0.003906c-8.9688-30.727-24.762-59.031-46.203-82.801-20.645-24.332-46.871-43.312-76.438-55.316-2.75-0.96484-5.7969 0.14844-7.2852 2.6523-1.4844 2.5078-1 5.7148 1.1641 7.6641 22.133 18.613 41.738 40.031 58.32 63.723 15.645 23.832 29.441 48.824 41.281 74.758l9.2383 19.68c2.6406 6.8398 5.2812 13.68 7.5586 20.641 2.2812 6.9609 3.3594 14.281 5.0391 21.359h0.003906c1.0508 7.3242 1.0508 14.758 0 22.082 0 7.4414-2.3984 14.762-2.3984 22.078h-0.003906c0.007813 3.6094 0.20703 7.2148 0.60156 10.801 0 3.6016 0 7.1992 0.71875 10.922 1.1875 15.082 3.7617 30.023 7.6797 44.641 0.70312 2.6211 2.9922 4.5117 5.7031 4.6992 2.707 0.19141 5.2383-1.3594 6.2969-3.8594 6.6992-14.402 10.762-29.887 12-45.723 2.2539-15.488 0.5625-31.297-4.918-45.961z"/>
            </svg>
            <div class="seal-text">
                15 <span class="pts">pts</span>
            </div>
        </div>
        
        <div class="congratulations">
            &ldquo;We ought, in every instance, to submit our reasoning to the test of experiment, and never to search for truth but by the natural road of experiment and observation.&rdquo;<br><br>
            Eureka, scientists! You've discovered <span class="grotesque-name">Antoine Lavoisier</span>, the prominent French chemist who revolutionized 18th-century chemistry.
        </div>
        
        <div class="instructions">
            To claim your <span class="points">15 points</span>, you must first watch the video about Antoine Lavoisier, 
            then correctly answer the question that follows.
        </div>

        <div class="button-container">
            <button class="button" id="videoButton" data-step="1">Watch Video</button>
            <button class="button" id="formButton" data-step="2">Answer Question</button>
        </div>
    </div>

    <!-- Video Modal -->
    <div id="videoModal" class="modal" role="dialog" aria-labelledby="videoModalTitle" aria-hidden="true">
        <div class="modal-content">
            <button class="close-button" aria-label="Close video">&times;</button>
            <h2 id="videoModalTitle" class="sr-only">Antoine Lavoisier Video</h2>
            <div class="video-container">
                <div id="videoPlaceholder" class="video-placeholder">
                    <div class="spinner"></div> Loading video...
                </div>
                <iframe 
                    id="videoFrame"
                    src="about:blank"
                    data-src="https://www.youtube.com/embed/7BUBPgWsJyo?si=Afiv-LFbtjngAdpe"
                    title="Antoine Lavoisier Video"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen>
                </iframe>
            </div>
            <div class="modal-buttons">
                <button class="modal-button" id="videoBackButton">Back to Main</button>
                <button class="modal-button" id="proceedToFormButton">Proceed to Question</button>
            </div>
        </div>
    </div>

    <!-- Form Modal -->
    <div id="formModal" class="modal" role="dialog" aria-labelledby="formModalTitle" aria-hidden="true">
        <div class="modal-content">
            <button class="close-button" aria-label="Close form">&times;</button>
            <h2 id="formModalTitle" class="sr-only">Antoine Lavoisier Question</h2>
            <div class="form-container">
                <div id="formLoading" class="form-loading">
                    <div class="spinner"></div> Loading form...
                </div>
                <iframe 
                    id="formFrame"
                    src="about:blank"
                    data-src="https://docs.google.com/forms/d/e/1FAIpQLSciuRNFIUcg0aBUgkH136XRVZb6LGwJI5cRNQuvEnUdSxU8Bw/viewform?embedded=true"
                    title="Antoine Lavoisier Question Form">
                </iframe>
            </div>
            <div class="modal-buttons">
                <button class="modal-button" id="formBackButton">Back to Main</button>
            </div>
        </div>
    </div>

    <script>
        // Helper for screen readers
        document.head.insertAdjacentHTML('beforeend', `
            <style>
                .sr-only {
                    position: absolute;
                    width: 1px;
                    height: 1px;
                    padding: 0;
                    margin: -1px;
                    overflow: hidden;
                    clip: rect(0, 0, 0, 0);
                    white-space: nowrap;
                    border: 0;
                }
            </style>
        `);
        
        // Cache DOM elements
        const videoButton = document.getElementById('videoButton');
        const formButton = document.getElementById('formButton');
        const videoModal = document.getElementById('videoModal');
        const formModal = document.getElementById('formModal');
        const videoFrame = document.getElementById('videoFrame');
        const formFrame = document.getElementById('formFrame');
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const formLoading = document.getElementById('formLoading');
        const closeButtons = document.querySelectorAll('.close-button');
        const videoBackButton = document.getElementById('videoBackButton');
        const formBackButton = document.getElementById('formBackButton');
        const proceedToFormButton = document.getElementById('proceedToFormButton');
        
        // Get iframe source URLs from data attributes
        const videoSrc = videoFrame.getAttribute('data-src');
        const formSrc = formFrame.getAttribute('data-src');
        
        // Add event listeners
        videoButton.addEventListener('click', () => openModal(videoModal, videoFrame, videoSrc));
        formButton.addEventListener('click', () => openModal(formModal, formFrame, formSrc));
        
        videoBackButton.addEventListener('click', () => closeModal(videoModal));
        formBackButton.addEventListener('click', () => closeModal(formModal));
        
        closeButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modal = button.closest('.modal');
                closeModal(modal);
            });
        });
        
        proceedToFormButton.addEventListener('click', () => {
            closeModal(videoModal);
            openModal(formModal, formFrame, formSrc);
        });
        
        // Handle clicks outside the modal content
        window.addEventListener('click', (event) => {
            if (event.target.classList.contains('modal')) {
                closeModal(event.target);
            }
        });
        
        // Handle escape key press
        window.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                if (videoModal.style.display === 'block') {
                    closeModal(videoModal);
                } else if (formModal.style.display === 'block') {
                    closeModal(formModal);
                }
            }
        });
        
        // Modal functions
        function openModal(modal, iframe, src) {
            // Set the iframe src only when opening to save resources
            if (iframe.src === 'about:blank' && src) {
                iframe.src = src;
                
                // Handle iframe load event
                iframe.onload = () => {
                    if (iframe === videoFrame) {
                        videoPlaceholder.style.display = 'none';
                    } else if (iframe === formFrame) {
                        formLoading.style.display = 'none';
                        iframe.classList.add('loaded');
                    }
                };
            }
            
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            // Focus trap for accessibility
            const focusableElements = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (focusableElements.length > 0) {
                setTimeout(() => {
                    focusableElements[0].focus();
                }, 100);
            }
            
            // Trigger animation
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
        }
        
        function closeModal(modal) {
            modal.classList.remove('active');
            
            // Wait for animation to complete
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                
                // Stop video if closing video modal
                if (modal === videoModal && videoFrame.src !== 'about:blank') {
                    videoFrame.src = 'about:blank';
                    videoFrame.src = videoSrc;
                    videoPlaceholder.style.display = 'flex';
                }
            }, 300);
        }
        
        // Preload the form in the background after page is fully loaded
        window.addEventListener('load', () => {
            // Preload the form after a short delay
            setTimeout(() => {
                const tempFrame = document.createElement('iframe');
                tempFrame.style.display = 'none';
                tempFrame.src = formSrc;
                document.body.appendChild(tempFrame);
                
                // Remove the temporary frame after it's loaded
                tempFrame.onload = () => {
                    setTimeout(() => {
                        document.body.removeChild(tempFrame);
                    }, 1000);
                };
            }, 2000);
        });
        
        // Detect network status
        window.addEventListener('online', updateNetworkStatus);
        window.addEventListener('offline', updateNetworkStatus);
        
        function updateNetworkStatus() {
            const isOnline = navigator.onLine;
            const container = document.querySelector('.container');
            
            if (!isOnline) {
                // If offline, show a notification
                if (!document.getElementById('offlineNotice')) {
                    const notice = document.createElement('div');
                    notice.id = 'offlineNotice';
                    notice.style.cssText = 'background:#f8d7da;color:#721c24;padding:10px;text-align:center;margin-bottom:16px;border-radius:4px;';
                    notice.innerHTML = 'You are currently offline. Some features may not work properly.';
                    container.insertBefore(notice, container.firstChild);
                }
            } else {
                // If back online, remove the notification
                const notice = document.getElementById('offlineNotice');
                if (notice) {
                    notice.remove();
                }
            }
        }
        
        // Check initial network status
        updateNetworkStatus();
    </script>
</body>
</html>